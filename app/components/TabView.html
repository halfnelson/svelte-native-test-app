<script context="module">
    export const TABS = {};
</script>
   
<script>
    import { setContext, onMount } from 'svelte';
    import { cleanProps } from './util.js'
    import { TabViewItem } from 'tns-core-modules/ui/tab-view'
    let tabView;
    let items = [];
    let dirtyProps;
    let props;
    $: props = cleanProps(dirtyProps);

    setContext(TABS, {
        addItem: (title, getView) => {
            return items.push({title, getView});
        }
    })

    onMount(()=>{
        let tabItems = [];
        for(let { title, getView} of items) {
            let tvi = new TabViewItem();
            tvi.title = title;
            tvi.view = getView();
            console.log("adding",tvi.title, tvi.view);
            tabItems.push(tvi);
        }
        tabView.nativeView.items = tabItems;
    })
</script>
<svelte:options bind:props={dirtyProps} />

<tabView {...props} bind:this={tabView}>
<slot></slot>
</tabView>